<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rwanda CV Builder Create Professional CV</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
<link rel="stylesheet" href="index.css">
</head> 
<body>
    <!-- Animated Background -->
    <div class="animated-bg">
        <div class="gradient-orb orb-1"></div>
        <div class="gradient-orb orb-2"></div>
        <div class="gradient-orb orb-3"></div>
    </div>

    <!-- Navigation -->
    <nav class="navigation">
        <div class="nav-container">
            <div class="nav-content">
                <div class="nav-brand">
                    <div class="nav-logo">
                        <i class="fas fa-file-alt"></i>
                    </div>
                    <div>
                        <div class="nav-title">Rwanda CV Builder</div>
                        <div class="nav-subtitle">Create your professional CV</div>
                    </div>
                </div>
                <div class="nav-steps">
                    <div class="nav-step current" data-page="personal">
                        <i class="fas fa-user"></i>
                        <span>Personal</span>
                    </div>
                    <div class="nav-step disabled" data-page="education">
                        <i class="fas fa-graduation-cap"></i>
                        <span>Education</span>
                    </div>
                    <div class="nav-step disabled" data-page="experience">
                        <i class="fas fa-briefcase"></i>
                        <span>Experience</span>
                    </div>
                    <div class="nav-step disabled" data-page="skills">
                        <i class="fas fa-cogs"></i>
                        <span>Skills</span>
                    </div>
                    <div class="nav-step disabled" data-page="references">
                        <i class="fas fa-users"></i>
                        <span>References</span>
                    </div>
                    <div class="nav-step disabled" data-page="preview">
                        <i class="fas fa-eye"></i>
                        <span>Preview</span>
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <div class="container">
        <!-- Personal Information Page -->
        <div id="personal" class="page active">
            <div class="form-container">
                <div class="form-section">
                    <div class="form-header">
                        <h2 class="form-title">
                            <i class="fas fa-user"></i>
                            Personal Information
                        </h2>
                        <p class="form-description">Tell us about yourself. This information will appear at the top of your CV.</p>
                    </div>

                    <div class="profile-upload">
                        <div class="profile-preview">
                            <div id="profilePlaceholder" class="profile-placeholder">JD</div>
                            <img id="profileImage" class="profile-image" style="display: none;" alt="Profile">
                            <label for="profileUpload" class="upload-btn">
                                <i class="fas fa-camera"></i>
                            </label>
                            <input type="file" id="profileUpload" accept="image/*" style="display: none;">
                        </div>
                        <p style="color: #6b7280; font-size: 0.875rem;">Upload your professional photo (optional)</p>
                    </div>

                    <div class="form-grid form-grid-2">
                        <div class="form-group">
                            <label class="form-label">Full Name *</label>
                            <input type="text" id="fullName" class="form-input" placeholder="Jean Baptiste Nkurunziza" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Professional Title *</label>
                            <input type="text" id="title" class="form-input" placeholder="Senior Software Engineer" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Email Address *</label>
                            <input type="email" id="email" class="form-input" placeholder="jean.baptiste@email.com" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Phone Number *</label>
                            <input type="tel" id="phone" class="form-input" placeholder="+250 788 123 456" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Location *</label>
                            <input type="text" id="location" class="form-input" placeholder="Kigali, Rwanda" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Website (Optional)</label>
                            <input type="url" id="website" class="form-input" placeholder="www.yourwebsite.com">
                        </div>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Professional Summary *</label>
                        <textarea id="summary" class="form-textarea" placeholder="Write a compelling professional summary that highlights your key strengths, experience, and career objectives. This should be 2-3 sentences that capture your professional essence." required></textarea>
                        <p style="color: #6b7280; font-size: 0.875rem; margin-top: 0.5rem;">
                            Tip: Keep it concise but impactful. Focus on your unique value proposition.
                        </p>
                    </div>

                    <div class="form-actions">
                        <div></div>
                        <button class="btn btn-primary" onclick="nextPage('education')">
                            Next: Education <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Education Page -->
        <div id="education" class="page">
            <div class="form-container">
                <div class="form-section">
                    <div class="form-header">
                        <h2 class="form-title">
                            <i class="fas fa-graduation-cap"></i>
                            Education Background
                        </h2>
                        <p class="form-description">Add your educational qualifications, starting with the most recent.</p>
                    </div>

                    <div id="educationList">
                        <div class="form-item" data-index="0">
                            <div class="form-item-header">
                                <h3 class="form-item-title">Education 1</h3>
                                <button class="remove-btn" onclick="removeItem('education', 0)" style="display: none;">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div class="form-grid form-grid-2">
                                <div class="form-group">
                                    <label class="form-label">Institution *</label>
                                    <input type="text" class="form-input education-institution" placeholder="University of Rwanda" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Degree Type *</label>
                                    <input type="text" class="form-input education-degree" placeholder="Bachelor of Science" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Field of Study *</label>
                                    <input type="text" class="form-input education-field" placeholder="Computer Science" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">GPA/Grade (Optional)</label>
                                    <input type="text" class="form-input education-gpa" placeholder="3.8/4.0 or First Class">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Start Year *</label>
                                    <input type="text" class="form-input education-start" placeholder="2019" >
                                </div>
                                <div class="form-group">
                                    <label class="form-label">End Year *</label>
                                    <input type="text" class="form-input education-end" placeholder="2023" >
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Description (Optional)</label>
                                <textarea class="form-textarea education-description" placeholder="Relevant coursework, projects, or achievements during your studies..."></textarea>
                            </div>
                        </div>
                    </div>

                    <button class="add-item-btn" onclick="addEducation()">
                        <i class="fas fa-plus"></i>
                        Add Another Education
                    </button>

                    <div class="form-actions">
                        <button class="btn btn-secondary" onclick="prevPage('personal')">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button class="btn btn-primary" onclick="nextPage('experience')">
                            Next: Experience <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Experience Page -->
        <div id="experience" class="page">
            <div class="form-container">
                <div class="form-section">
                    <div class="form-header">
                        <h2 class="form-title">
                            <i class="fas fa-briefcase"></i>
                            Professional Experience
                        </h2>
                        <p class="form-description">List your work experience, starting with your most recent position.</p>
                    </div>

                    <div id="experienceList">
                        <div class="form-item" data-index="0">
                            <div class="form-item-header">
                                <h3 class="form-item-title">Experience 1</h3>
                                <button class="remove-btn" onclick="removeItem('experience', 0)" style="display: none;">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div class="form-grid form-grid-2">
                                <div class="form-group">
                                    <label class="form-label">Company *</label>
                                    <input type="text" class="form-input experience-company" placeholder="Bank of Kigali" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Job Title *</label>
                                    <input type="text" class="form-input experience-position" placeholder="Senior Software Engineer" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Location *</label>
                                    <input type="text" class="form-input experience-location" placeholder="Kigali, Rwanda" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Duration *</label>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                                        <input type="text" class="form-input experience-start" placeholder="Jan 2022" required>
                                        <input type="text" class="form-input experience-end" placeholder="Present" required>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Key Responsibilities & Achievements *</label>
                                <div class="experience-descriptions">
                                    <div class="form-group" style="margin-bottom: 0.5rem;">
                                        <textarea class="form-textarea experience-description" placeholder="Key achievement or responsibility 1..." required style="min-height: 80px;"></textarea>
                                    </div>
                                </div>
                                <button type="button" class="btn btn-secondary" style="margin-top: 0.5rem;" onclick="addExperienceDescription(0)">
                                    <i class="fas fa-plus"></i> Add Achievement
                                </button>
                            </div>
                        </div>
                    </div>

                    <button class="add-item-btn" onclick="addExperience()">
                        <i class="fas fa-plus"></i>
                        Add Another Experience
                    </button>

                    <div class="form-actions">
                        <button class="btn btn-secondary" onclick="prevPage('education')">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button class="btn btn-primary" onclick="nextPage('skills')">
                            Next: Skills <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Skills & Achievements Page -->
        <div id="skills" class="page">
            <div class="form-container">
                <!-- Skills Section -->
                <div class="form-section">
                    <div class="form-header">
                        <h2 class="form-title">
                            <i class="fas fa-cogs"></i>
                            Technical Skills
                        </h2>
                        <p class="form-description">List your technical skills and proficiency levels.</p>
                    </div>

                    <div id="skillsList" class="skills-container">
                        <div class="skill-item" data-index="0">
                            <div class="form-group" style="flex: 1;">
                                <input type="text" class="form-input skill-name" placeholder="e.g., JavaScript, React, Python" required>
                            </div>
                            <div class="form-group skill-level">
                                <select class="form-select skill-level-select">
                                    <option value="Beginner">Beginner</option>
                                    <option value="Intermediate" selected>Intermediate</option>
                                    <option value="Advanced">Advanced</option>
                                    <option value="Expert">Expert</option>
                                </select>
                            </div>
                            <button class="remove-btn" onclick="removeItem('skills', 0)" style="display: none;">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>

                    <button class="add-item-btn" onclick="addSkill()">
                        <i class="fas fa-plus"></i>
                        Add Another Skill
                    </button>
                </div>

                <!-- Achievements Section -->
                <div class="form-section">
                    <div class="form-header">
                        <h2 class="form-title">
                            <i class="fas fa-trophy"></i>
                            Achievements & Awards
                        </h2>
                        <p class="form-description">Highlight your notable achievements, awards, and recognitions.</p>
                    </div>

                    <div id="achievementsList">
                        <div class="form-item" data-index="0">
                            <div class="form-item-header">
                                <h3 class="form-item-title">Achievement 1</h3>
                                <button class="remove-btn" onclick="removeItem('achievements', 0)" style="display: none;">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div class="form-grid form-grid-2">
                                <div class="form-group">
                                    <label class="form-label">Achievement Title *</label>
                                    <input type="text" class="form-input achievement-title" placeholder="Outstanding Developer Award" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Date *</label>
                                    <input type="text" class="form-input achievement-date" placeholder="2023" required>
                                </div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label class="form-label">Organization (Optional)</label>
                                    <input type="text" class="form-input achievement-organization" placeholder="Bank of Kigali">
                                </div>
                            </div>
                            
                            <div class="form-group">
                                <label class="form-label">Description *</label>
                                <textarea class="form-textarea achievement-description" placeholder="Brief description of the achievement and its significance..." required></textarea>
                            </div>
                        </div>
                    </div>

                    <button class="add-item-btn" onclick="addAchievement()">
                        <i class="fas fa-plus"></i>
                        Add Another Achievement
                    </button>

                    <div class="form-actions">
                        <button class="btn btn-secondary" onclick="prevPage('experience')">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button class="btn btn-primary" onclick="nextPage('references')">
                            Next: References <i class="fas fa-arrow-right"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- References Page -->
        <div id="references" class="page">
            <div class="form-container">
                <div class="form-section">
                    <div class="form-header">
                        <h2 class="form-title">
                            <i class="fas fa-users"></i>
                            Professional References
                        </h2>
                        <p class="form-description">Provide contacts of professional references who can vouch for your work experience and character.</p>
                    </div>

                    <div id="referencesList">
                        <div class="form-item" data-index="0">
                            <div class="form-item-header">
                                <h3 class="form-item-title">Reference 1</h3>
                                <button class="remove-btn" onclick="removeItem('references', 0)" style="display: none;">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                            
                            <div class="form-grid form-grid-2">
                                <div class="form-group">
                                    <label class="form-label">Full Name *</label>
                                    <input type="text" class="form-input reference-name" placeholder="Dr. Sarah Mugisha" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Job Title *</label>
                                    <input type="text" class="form-input reference-title" placeholder="Chief Technology Officer" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Company/Organization *</label>
                                    <input type="text" class="form-input reference-company" placeholder="Bank of Kigali" required>
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Email Address *</label>
                                    <input type="email" class="form-input reference-email" placeholder="sarah.mugisha@bk.rw" required>
                                </div>
                                <div class="form-group" style="grid-column: 1 / -1;">
                                    <label class="form-label">Phone Number *</label>
                                    <input type="tel" class="form-input reference-phone" placeholder="+250 788 567 890" required>
                                </div>
                            </div>
                        </div>
                    </div>

                    <button class="add-item-btn" onclick="addReference()">
                        <i class="fas fa-plus"></i>
                        Add Another Reference
                    </button>

                    <div style="background: #eff6ff; padding: 1rem; border-radius: 10px; border: 1px solid #bfdbfe; margin: 2rem 0;">
                        <h4 style="font-weight: 500; color: #1e40af; margin-bottom: 0.5rem;">Reference Guidelines:</h4>
                        <ul style="color: #3b82f6; font-size: 0.875rem; margin: 0; padding-left: 1.5rem;">
                            <li>Choose references who know your work professionally</li>
                            <li>Include former supervisors, colleagues, or clients</li>
                            <li>Always ask permission before listing someone as a reference</li>
                            <li>Provide accurate and current contact information</li>
                            <li>Consider including 2-4 references for a complete CV</li>
                        </ul>
                    </div>

                    <div class="form-actions">
                        <button class="btn btn-secondary" onclick="prevPage('skills')">
                            <i class="fas fa-arrow-left"></i> Previous
                        </button>
                        <button class="btn btn-primary" onclick="nextPage('preview')">
                            Preview CV <i class="fas fa-eye"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Preview Page -->
        <div id="preview" class="page">
            <div class="cv-preview-container">
                <div class="form-section">
                    <div class="form-header">
                        <h2 class="form-title">
                            <i class="fas fa-eye"></i>
                            CV Preview & Download
                        </h2>
                        <p class="form-description">Your professional CV is ready! Review and download your completed CV.</p>
                    </div>

                    <div class="success-message">
                        <i class="fas fa-check-circle"></i>
                        <strong>All sections completed successfully!</strong>
                    </div>

                    <div class="form-actions no-print">
                        <button class="btn btn-secondary" onclick="prevPage('references')">
                            <i class="fas fa-arrow-left"></i> Edit References
                        </button>
                        <div style="display: flex; gap: 1rem; flex-wrap: wrap;">
                            <button class="btn btn-secondary" onclick="goToPage('personal')">
                                <i class="fas fa-edit"></i> Make Changes
                            </button>
                            <button class="btn btn-success" onclick="downloadCV()" id="downloadBtn">
                                <i class="fas fa-download"></i> Download CV
                            </button>
                        </div>
                    </div>
                </div>

                <!-- CV Preview -->
                <div id="cvPreview" class="cv-preview">
                    <div class="cv-header">
                        <div class="cv-header-content">
                            <div>
                                <div id="cvProfileImage" class="cv-profile-placeholder">JD</div>
                            </div>
                            <div>
                                <h1 id="cvName" class="cv-name">Your Name</h1>
                                <h2 id="cvTitle" class="cv-title">Your Professional Title</h2>
                                <div class="cv-badges">
                                    <span class="cv-badge">Available for Work</span>
                                    <span class="cv-badge">Open to Opportunities</span>
                                    <span class="cv-badge">Remote Friendly</span>
                                </div>
                            </div>
                            <div class="cv-contact">
                                <div class="cv-contact-item">
                                    <i class="fas fa-envelope"></i>
                                    <span id="cvEmail">your.email@example.com</span>
                                </div>
                                <div class="cv-contact-item">
                                    <i class="fas fa-phone"></i>
                                    <span id="cvPhone">+250 XXX XXX XXX</span>
                                </div>
                                <div class="cv-contact-item">
                                    <i class="fas fa-map-marker-alt"></i>
                                    <span id="cvLocation">Your Location</span>
                                </div>
                                <div class="cv-contact-item" id="cvWebsiteItem" style="display: none;">
                                    <i class="fas fa-globe"></i>
                                    <span id="cvWebsite"></span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="cv-body">
                        <!-- About Me -->
                        <div class="cv-section">
                            <h3 class="cv-section-title">
                                <i class="fas fa-user"></i>
                                About Me
                            </h3>
                            <div class="cv-section-content">
                                <p id="cvSummary">Your professional summary will appear here...</p>
                            </div>
                        </div>

                        <!-- Experience -->
                        <div class="cv-section">
                            <h3 class="cv-section-title">
                                <i class="fas fa-briefcase"></i>
                                Professional Experience
                            </h3>
                            <div id="cvExperienceSection" class="cv-section-content">
                                <!-- Experience items will be populated here -->
                            </div>
                        </div>

                        <!-- Education -->
                        <div class="cv-section">
                            <h3 class="cv-section-title">
                                <i class="fas fa-graduation-cap"></i>
                                Education
                            </h3>
                            <div id="cvEducationSection" class="cv-section-content">
                                <!-- Education items will be populated here -->
                            </div>
                        </div>

                        <!-- Skills -->
                        <div class="cv-section">
                            <h3 class="cv-section-title">
                                <i class="fas fa-code"></i>
                                Technical Skills
                            </h3>
                            <div class="cv-section-content">
                                <div id="cvSkillsSection" class="cv-skills-grid">
                                    <!-- Skills will be populated here -->
                                </div>
                            </div>
                        </div>

                        <!-- Achievements -->
                        <div class="cv-section">
                            <h3 class="cv-section-title">
                                <i class="fas fa-trophy"></i>
                                Achievements & Awards
                            </h3>
                            <div id="cvAchievementsSection" class="cv-section-content cv-achievements-grid">
                                <!-- Achievements will be populated here -->
                            </div>
                        </div>

                        <!-- References -->
                        <div class="cv-section">
                            <h3 class="cv-section-title">
                                <i class="fas fa-users"></i>
                                Professional References
                            </h3>
                            <div id="cvReferencesSection" class="cv-section-content cv-references-grid">
                                <!-- References will be populated here -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Progress Indicator -->
    <div class="progress-indicator">
        <div class="progress-text">Progress: <span id="progressCount">0</span>/5 sections</div>
        <div class="progress-bar">
            <div id="progressFill" class="progress-fill" style="width: 0%"></div>
        </div>
    </div>

    <script>
        // Global variables
        let currentPage = 'personal';
        let completedSections = [];
        let educationCount = 1;
        let experienceCount = 1;
        let skillsCount = 1;
        let achievementsCount = 1;
        let referencesCount = 1;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            updateNavigation();
            updateProgress();
            
            // Profile image upload
            document.getElementById('profileUpload').addEventListener('change', handleProfileUpload);
            
            // Auto-save form data
            setupAutoSave();
            
            // Load saved data
            loadSavedData();
        });

        // Navigation functions
        function goToPage(page) {
            // Hide current page
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            
            // Show target page
            document.getElementById(page).classList.add('active');
            currentPage = page;
            
            // Update navigation
            updateNavigation();
            
            // Update CV preview if on preview page
            if (page === 'preview') {
                updateCVPreview();
            }
        }

        function nextPage(targetPage) {
            if (validateCurrentPage()) {
                markSectionCompleted(currentPage);
                goToPage(targetPage);
            }
        }

        function prevPage(targetPage) {
            goToPage(targetPage);
        }

        function updateNavigation() {
            const steps = document.querySelectorAll('.nav-step');
            steps.forEach(step => {
                const page = step.dataset.page;
                step.classList.remove('current', 'completed', 'disabled');
                
                if (page === currentPage) {
                    step.classList.add('current');
                } else if (completedSections.includes(page)) {
                    step.classList.add('completed');
                } else if (isPageAccessible(page)) {
                    // Page is accessible
                } else {
                    step.classList.add('disabled');
                }
                
                step.onclick = () => {
                    if (!step.classList.contains('disabled')) {
                        goToPage(page);
                    }
                };
            });
        }

        function isPageAccessible(page) {
            const pages = ['personal', 'education', 'experience', 'skills', 'references', 'preview'];
            const pageIndex = pages.indexOf(page);
            const currentIndex = pages.indexOf(currentPage);
            
            // Can access current page or completed pages or preview
            if (page === currentPage || completedSections.includes(page) || page === 'preview') {
                return true;
            }
            
            // Can access next page if current page is completed
            return pageIndex === currentIndex + 1 && validateCurrentPage();
        }

        function markSectionCompleted(section) {
            if (!completedSections.includes(section)) {
                completedSections.push(section);
                updateProgress();
            }
        }

        function updateProgress() {
            const progress = (completedSections.length / 5) * 100;
            document.getElementById('progressCount').textContent = completedSections.length;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        // Validation functions
        function validateCurrentPage() {
            clearErrors();
            
            switch (currentPage) {
                case 'personal':
                    return validatePersonalInfo();
                case 'education':
                    return validateEducation();
                case 'experience':
                    return validateExperience();
                case 'skills':
                    return validateSkills();
                case 'references':
                    return validateReferences();
                default:
                    return true;
            }
        }

        function clearErrors() {
            document.querySelectorAll('.form-input, .form-textarea, .form-select').forEach(el => {
                el.classList.remove('error');
            });
            document.querySelectorAll('.error-message').forEach(el => el.remove());
        }

        function showError(element, message) {
            element.classList.add('error');
            element.focus();
            
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = message;
            element.parentNode.appendChild(errorDiv);
        }

        function validatePersonalInfo() {
            const required = [
                { id: 'fullName', name: 'Full Name' },
                { id: 'title', name: 'Professional Title' },
                { id: 'email', name: 'Email Address' },
                { id: 'phone', name: 'Phone Number' },
                { id: 'location', name: 'Location' },
                { id: 'summary', name: 'Professional Summary' }
            ];
            
            for (let field of required) {
                const element = document.getElementById(field.id);
                if (!element.value.trim()) {
                    showError(element, `${field.name} is required.`);
                    return false;
                }
            }
            return true;
        }

        function validateEducation() {
            const educationItems = document.querySelectorAll('#educationList .form-item');
            for (let item of educationItems) {
                const required = [
                    { className: 'education-institution', name: 'Institution' },
                    { className: 'education-degree', name: 'Degree Type' },
                    { className: 'education-field', name: 'Field of Study' },
                    { className: 'education-start', name: 'Start Year' },
                    { className: 'education-end', name: 'End Year' }
                ];
                
                for (let field of required) {
                    const element = item.querySelector('.' + field.className);
                    if (!element.value.trim()) {
                        showError(element, `${field.name} is required.`);
                        return false;
                    }
                }
            }
            return true;
        }

        function validateExperience() {
            const experienceItems = document.querySelectorAll('#experienceList .form-item');
            for (let item of experienceItems) {
                const required = [
                    { className: 'experience-company', name: 'Company' },
                    { className: 'experience-position', name: 'Job Title' },
                    { className: 'experience-location', name: 'Location' },
                    { className: 'experience-start', name: 'Start Date' },
                    { className: 'experience-end', name: 'End Date' }
                ];
                
                for (let field of required) {
                    const element = item.querySelector('.' + field.className);
                    if (!element.value.trim()) {
                        showError(element, `${field.name} is required.`);
                        return false;
                    }
                }
                
                // Check if at least one description exists and is filled
                const descriptions = item.querySelectorAll('.experience-description');
                let hasDescription = false;
                for (let desc of descriptions) {
                    if (desc.value.trim()) {
                        hasDescription = true;
                        break;
                    }
                }
                if (!hasDescription) {
                    showError(descriptions[0], 'At least one responsibility or achievement is required.');
                    return false;
                }
            }
            return true;
        }

        function validateSkills() {
            const skillItems = document.querySelectorAll('#skillsList .skill-item');
            for (let item of skillItems) {
                const nameInput = item.querySelector('.skill-name');
                if (!nameInput.value.trim()) {
                    showError(nameInput, 'Skill name is required.');
                    return false;
                }
            }
            
            const achievementItems = document.querySelectorAll('#achievementsList .form-item');
            for (let item of achievementItems) {
                const required = [
                    { className: 'achievement-title', name: 'Achievement Title' },
                    { className: 'achievement-date', name: 'Date' },
                    { className: 'achievement-description', name: 'Description' }
                ];
                
                for (let field of required) {
                    const element = item.querySelector('.' + field.className);
                    if (!element.value.trim()) {
                        showError(element, `${field.name} is required.`);
                        return false;
                    }
                }
            }
            return true;
        }

        function validateReferences() {
            const referenceItems = document.querySelectorAll('#referencesList .form-item');
            for (let item of referenceItems) {
                const required = [
                    { className: 'reference-name', name: 'Full Name' },
                    { className: 'reference-title', name: 'Job Title' },
                    { className: 'reference-company', name: 'Company' },
                    { className: 'reference-email', name: 'Email Address' },
                    { className: 'reference-phone', name: 'Phone Number' }
                ];
                
                for (let field of required) {
                    const element = item.querySelector('.' + field.className);
                    if (!element.value.trim()) {
                        showError(element, `${field.name} is required.`);
                        return false;
                    }
                }
            }
            return true;
        }

        // Profile image handling
        function handleProfileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const placeholder = document.getElementById('profilePlaceholder');
                    const image = document.getElementById('profileImage');
                    
                    placeholder.style.display = 'none';
                    image.src = e.target.result;
                    image.style.display = 'block';
                    
                    // Save to localStorage
                    localStorage.setItem('cvProfileImage', e.target.result);
                };
                reader.readAsDataURL(file);
            }
        }

        // Dynamic form management
        function addEducation() {
            const container = document.getElementById('educationList');
            const newItem = createEducationItem(educationCount);
            container.appendChild(newItem);
            educationCount++;
            updateRemoveButtons('education');
        }

        function addExperience() {
            const container = document.getElementById('experienceList');
            const newItem = createExperienceItem(experienceCount);
            container.appendChild(newItem);
            experienceCount++;
            updateRemoveButtons('experience');
        }

        function addSkill() {
            const container = document.getElementById('skillsList');
            const newItem = createSkillItem(skillsCount);
            container.appendChild(newItem);
            skillsCount++;
            updateRemoveButtons('skills');
        }

        function addAchievement() {
            const container = document.getElementById('achievementsList');
            const newItem = createAchievementItem(achievementsCount);
            container.appendChild(newItem);
            achievementsCount++;
            updateRemoveButtons('achievements');
        }

        function addReference() {
            const container = document.getElementById('referencesList');
            const newItem = createReferenceItem(referencesCount);
            container.appendChild(newItem);
            referencesCount++;
            updateRemoveButtons('references');
        }

        function removeItem(type, index) {
            const container = document.getElementById(type + 'List');
            const item = container.querySelector(`[data-index="${index}"]`);
            if (item) {
                item.remove();
                updateRemoveButtons(type);
            }
        }

        function updateRemoveButtons(type) {
            const container = document.getElementById(type + 'List');
            const items = container.querySelectorAll('.form-item, .skill-item');
            
            items.forEach((item, index) => {
                const removeBtn = item.querySelector('.remove-btn');
                if (removeBtn) {
                    removeBtn.style.display = items.length > 1 ? 'block' : 'none';
                }
            });
        }

        function createEducationItem(index) {
            const div = document.createElement('div');
            div.className = 'form-item';
            div.setAttribute('data-index', index);
            div.innerHTML = `
                <div class="form-item-header">
                    <h3 class="form-item-title">Education ${index + 1}</h3>
                    <button class="remove-btn" onclick="removeItem('education', ${index})">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="form-grid form-grid-2">
                    <div class="form-group">
                        <label class="form-label">Institution *</label>
                        <input type="text" class="form-input education-institution" placeholder="University of Rwanda" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Degree Type *</label>
                        <input type="text" class="form-input education-degree" placeholder="Bachelor of Science" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Field of Study *</label>
                        <input type="text" class="form-input education-field" placeholder="Computer Science" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">GPA/Grade (Optional)</label>
                        <input type="text" class="form-input education-gpa" placeholder="3.8/4.0 or First Class">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Start Year *</label>
                        <input type="text" class="form-input education-start" placeholder="2019" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">End Year *</label>
                        <input type="text" class="form-input education-end" placeholder="2023" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Description (Optional)</label>
                    <textarea class="form-textarea education-description" placeholder="Relevant coursework, projects, or achievements during your studies..."></textarea>
                </div>
            `;
            return div;
        }

        function createExperienceItem(index) {
            const div = document.createElement('div');
            div.className = 'form-item';
            div.setAttribute('data-index', index);
            div.innerHTML = `
                <div class="form-item-header">
                    <h3 class="form-item-title">Experience ${index + 1}</h3>
                    <button class="remove-btn" onclick="removeItem('experience', ${index})">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="form-grid form-grid-2">
                    <div class="form-group">
                        <label class="form-label">Company *</label>
                        <input type="text" class="form-input experience-company" placeholder="Bank of Kigali" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Job Title *</label>
                        <input type="text" class="form-input experience-position" placeholder="Senior Software Engineer" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Location *</label>
                        <input type="text" class="form-input experience-location" placeholder="Kigali, Rwanda" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Duration *</label>
                        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 0.5rem;">
                            <input type="text" class="form-input experience-start" placeholder="Jan 2022" required>
                            <input type="text" class="form-input experience-end" placeholder="Present" required>
                        </div>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Key Responsibilities & Achievements *</label>
                    <div class="experience-descriptions">
                        <div class="form-group" style="margin-bottom: 0.5rem;">
                            <textarea class="form-textarea experience-description" placeholder="Key achievement or responsibility 1..." required style="min-height: 80px;"></textarea>
                        </div>
                    </div>
                    <button type="button" class="btn btn-secondary" style="margin-top: 0.5rem;" onclick="addExperienceDescription(${index})">
                        <i class="fas fa-plus"></i> Add Achievement
                    </button>
                </div>
            `;
            return div;
        }

        function createSkillItem(index) {
            const div = document.createElement('div');
            div.className = 'skill-item';
            div.setAttribute('data-index', index);
            div.innerHTML = `
                <div class="form-group" style="flex: 1;">
                    <input type="text" class="form-input skill-name" placeholder="e.g., JavaScript, React, Python" required>
                </div>
                <div class="form-group skill-level">
                    <select class="form-select skill-level-select">
                        <option value="Beginner">Beginner</option>
                        <option value="Intermediate" selected>Intermediate</option>
                        <option value="Advanced">Advanced</option>
                        <option value="Expert">Expert</option>
                    </select>
                </div>
                <button class="remove-btn" onclick="removeItem('skills', ${index})">
                    <i class="fas fa-times"></i>
                </button>
            `;
            return div;
        }

        function createAchievementItem(index) {
            const div = document.createElement('div');
            div.className = 'form-item';
            div.setAttribute('data-index', index);
            div.innerHTML = `
                <div class="form-item-header">
                    <h3 class="form-item-title">Achievement ${index + 1}</h3>
                    <button class="remove-btn" onclick="removeItem('achievements', ${index})">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="form-grid form-grid-2">
                    <div class="form-group">
                        <label class="form-label">Achievement Title *</label>
                        <input type="text" class="form-input achievement-title" placeholder="Outstanding Developer Award" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Date *</label>
                        <input type="text" class="form-input achievement-date" placeholder="2023" required>
                    </div>
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <label class="form-label">Organization (Optional)</label>
                        <input type="text" class="form-input achievement-organization" placeholder="Bank of Kigali">
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">Description *</label>
                    <textarea class="form-textarea achievement-description" placeholder="Brief description of the achievement and its significance..." required></textarea>
                </div>
            `;
            return div;
        }

        function createReferenceItem(index) {
            const div = document.createElement('div');
            div.className = 'form-item';
            div.setAttribute('data-index', index);
            div.innerHTML = `
                <div class="form-item-header">
                    <h3 class="form-item-title">Reference ${index + 1}</h3>
                    <button class="remove-btn" onclick="removeItem('references', ${index})">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                
                <div class="form-grid form-grid-2">
                    <div class="form-group">
                        <label class="form-label">Full Name *</label>
                        <input type="text" class="form-input reference-name" placeholder="Dr. Sarah Mugisha" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Job Title *</label>
                        <input type="text" class="form-input reference-title" placeholder="Chief Technology Officer" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Company/Organization *</label>
                        <input type="text" class="form-input reference-company" placeholder="Bank of Kigali" required>
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email Address *</label>
                        <input type="email" class="form-input reference-email" placeholder="sarah.mugisha@bk.rw" required>
                    </div>
                    <div class="form-group" style="grid-column: 1 / -1;">
                        <label class="form-label">Phone Number *</label>
                        <input type="tel" class="form-input reference-phone" placeholder="+250 788 567 890" required>
                    </div>
                </div>
            `;
            return div;
        }

        function addExperienceDescription(experienceIndex) {
            const experienceItem = document.querySelector(`#experienceList .form-item[data-index="${experienceIndex}"]`);
            const descriptionsContainer = experienceItem.querySelector('.experience-descriptions');
            
            const newDescription = document.createElement('div');
            newDescription.className = 'form-group';
            newDescription.style.marginBottom = '0.5rem';
            newDescription.innerHTML = `
                <div style="display: flex; gap: 0.5rem;">
                    <textarea class="form-textarea experience-description" placeholder="Another key achievement or responsibility..." style="min-height: 80px; flex: 1;"></textarea>
                    <button type="button" class="remove-btn" onclick="this.closest('.form-group').remove()" style="height: fit-content; margin-top: 0.25rem;">
                        <i class="fas fa-minus"></i>
                    </button>
                </div>
            `;
            
            descriptionsContainer.appendChild(newDescription);
        }

        // CV Preview functions
        function updateCVPreview() {
            updatePersonalInfoPreview();
            updateEducationPreview();
            updateExperiencePreview();
            updateSkillsPreview();
            updateAchievementsPreview();
            updateReferencesPreview();
        }

        function updatePersonalInfoPreview() {
            const fullName = document.getElementById('fullName').value || 'Your Name';
            const title = document.getElementById('title').value || 'Your Professional Title';
            const email = document.getElementById('email').value || 'your.email@example.com';
            const phone = document.getElementById('phone').value || '+250 XXX XXX XXX';
            const location = document.getElementById('location').value || 'Your Location';
            const website = document.getElementById('website').value;
            const summary = document.getElementById('summary').value || 'Your professional summary will appear here...';

            document.getElementById('cvName').textContent = fullName;
            document.getElementById('cvTitle').textContent = title;
            document.getElementById('cvEmail').textContent = email;
            document.getElementById('cvPhone').textContent = phone;
            document.getElementById('cvLocation').textContent = location;
            document.getElementById('cvSummary').textContent = summary;

            // Handle website
            const websiteItem = document.getElementById('cvWebsiteItem');
            if (website) {
                document.getElementById('cvWebsite').textContent = website;
                websiteItem.style.display = 'flex';
            } else {
                websiteItem.style.display = 'none';
            }

            // Handle profile image
            const savedImage = localStorage.getItem('cvProfileImage');
            const cvProfileImage = document.getElementById('cvProfileImage');
            
            if (savedImage) {
                cvProfileImage.innerHTML = `<img src="${savedImage}" class="cv-profile-image" alt="Profile">`;
            } else {
                const initials = fullName.split(' ').map(n => n[0]).join('').toUpperCase();
                cvProfileImage.innerHTML = initials;
                cvProfileImage.className = 'cv-profile-placeholder';
            }
        }

        function updateEducationPreview() {
            const container = document.getElementById('cvEducationSection');
            const educationItems = document.querySelectorAll('#educationList .form-item');
            
            container.innerHTML = '';
            
            educationItems.forEach(item => {
                const institution = item.querySelector('.education-institution').value;
                const degree = item.querySelector('.education-degree').value;
                const field = item.querySelector('.education-field').value;
                const gpa = item.querySelector('.education-gpa').value;
                const start = item.querySelector('.education-start').value;
                const end = item.querySelector('.education-end').value;
                const description = item.querySelector('.education-description').value;
                
                if (institution || degree || field) {
                    const eduDiv = document.createElement('div');
                    eduDiv.className = 'cv-education-item';
                    eduDiv.innerHTML = `
                        <div class="cv-item-header">
                            <div>
                                <div class="cv-item-title">${institution}</div>
                                <div class="cv-item-subtitle">${degree} in ${field}</div>
                                ${gpa ? `<div style="color: #10b981; font-weight: 500; font-size: 0.875rem;">GPA: ${gpa}</div>` : ''}
                            </div>
                            <div class="cv-item-date">${start} - ${end}</div>
                        </div>
                        ${description ? `<div class="cv-description">${description}</div>` : ''}
                    `;
                    container.appendChild(eduDiv);
                }
            });
        }

        function updateExperiencePreview() {
            const container = document.getElementById('cvExperienceSection');
            const experienceItems = document.querySelectorAll('#experienceList .form-item');
            
            container.innerHTML = '';
            
            experienceItems.forEach(item => {
                const company = item.querySelector('.experience-company').value;
                const position = item.querySelector('.experience-position').value;
                const location = item.querySelector('.experience-location').value;
                const start = item.querySelector('.experience-start').value;
                const end = item.querySelector('.experience-end').value;
                const descriptions = Array.from(item.querySelectorAll('.experience-description')).map(desc => desc.value).filter(desc => desc.trim());
                
                if (company || position) {
                    const expDiv = document.createElement('div');
                    expDiv.className = 'cv-experience-item';
                    
                    let descriptionsHtml = '';
                    if (descriptions.length > 0) {
                        descriptionsHtml = '<ul>' + descriptions.map(desc => `<li>${desc}</li>`).join('') + '</ul>';
                    }
                    
                    expDiv.innerHTML = `
                        <div class="cv-item-header">
                            <div>
                                <div class="cv-item-title">${position}</div>
                                <div class="cv-item-subtitle">${company}  ${location}</div>
                            </div>
                            <div class="cv-item-date">${start} - ${end}</div>
                        </div>
                        ${descriptionsHtml ? `<div class="cv-description">${descriptionsHtml}</div>` : ''}
                    `;
                    container.appendChild(expDiv);
                }
            });
        }

        function updateSkillsPreview() {
            const container = document.getElementById('cvSkillsSection');
            const skillItems = document.querySelectorAll('#skillsList .skill-item');
            
            container.innerHTML = '';
            
            skillItems.forEach(item => {
                const name = item.querySelector('.skill-name').value;
                const level = item.querySelector('.skill-level-select').value;
                
                if (name) {
                    const skillSpan = document.createElement('span');
                    skillSpan.className = `skill-badge skill-${level.toLowerCase()}`;
                    skillSpan.textContent = name;
                    container.appendChild(skillSpan);
                }
            });
        }

        function updateAchievementsPreview() {
            const container = document.getElementById('cvAchievementsSection');
            const achievementItems = document.querySelectorAll('#achievementsList .form-item');
            
            container.innerHTML = '';
            
            achievementItems.forEach(item => {
                const title = item.querySelector('.achievement-title').value;
                const date = item.querySelector('.achievement-date').value;
                const organization = item.querySelector('.achievement-organization').value;
                const description = item.querySelector('.achievement-description').value;
                
                if (title || description) {
                    const achDiv = document.createElement('div');
                    achDiv.className = 'cv-achievement-item';
                    achDiv.innerHTML = `
                        <div class="cv-achievement-title">${title} - ${date}</div>
                        ${organization ? `<div class="cv-achievement-org">${organization}</div>` : ''}
                        <div class="cv-achievement-desc">${description}</div>
                    `;
                    container.appendChild(achDiv);
                }
            });
        }

        function updateReferencesPreview() {
            const container = document.getElementById('cvReferencesSection');
            const referenceItems = document.querySelectorAll('#referencesList .form-item');
            
            container.innerHTML = '';
            
            referenceItems.forEach(item => {
                const name = item.querySelector('.reference-name').value;
                const title = item.querySelector('.reference-title').value;
                const company = item.querySelector('.reference-company').value;
                const email = item.querySelector('.reference-email').value;
                const phone = item.querySelector('.reference-phone').value;
                
                if (name || title) {
                    const refDiv = document.createElement('div');
                    refDiv.className = 'cv-reference-item';
                    refDiv.innerHTML = `
                        <div class="cv-reference-name">${name}</div>
                        <div class="cv-reference-title">${title}</div>
                        <div style="color: #6366f1; font-weight: 500; margin: 0.25rem 0;">${company}</div>
                        <div class="cv-reference-contact">
                            <div>${email}</div>
                            <div>${phone}</div>
                        </div>
                    `;
                    container.appendChild(refDiv);
                }
            });
        }

        // Download CV function
        function downloadCV() {
            const element = document.getElementById('cvPreview');
            const downloadBtn = document.getElementById('downloadBtn');
            const originalText = downloadBtn.innerHTML;
            
            // Show loading state
            downloadBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating PDF...';
            downloadBtn.disabled = true;
            
            const opt = {
                margin: 0.5,
                filename: `${document.getElementById('fullName').value || 'CV'}_CV.pdf`,
                image: { type: 'jpeg', quality: 0.98 },
                html2canvas: { 
                    scale: 2, 
                    useCORS: true,
                    letterRendering: true,
                    allowTaint: false
                },
                jsPDF: { 
                    unit: 'in', 
                    format: 'a4', 
                    orientation: 'portrait'
                }
            };

            html2pdf().set(opt).from(element).save()
                .then(() => {
                    // Reset button
                    downloadBtn.innerHTML = originalText;
                    downloadBtn.disabled = false;
                })
                .catch((error) => {
                    console.error('PDF generation failed:', error);
                    // Fallback to print
                    alert('PDF generation failed. Trying alternative method...');
                    window.print();
                    downloadBtn.innerHTML = originalText;
                    downloadBtn.disabled = false;
                });
        }

        // Auto-save functionality
        function setupAutoSave() {
            // Debounce function to avoid excessive saving
            let saveTimeout;
            
            function debouncedSave() {
                clearTimeout(saveTimeout);
                saveTimeout = setTimeout(saveFormData, 1000);
            }
            
            // Add event listeners for auto-save
            document.addEventListener('input', debouncedSave);
            document.addEventListener('change', debouncedSave);
        }

        function saveFormData() {
            try {
                const formData = {
                    personal: {
                        fullName: document.getElementById('fullName').value,
                        title: document.getElementById('title').value,
                        email: document.getElementById('email').value,
                        phone: document.getElementById('phone').value,
                        location: document.getElementById('location').value,
                        website: document.getElementById('website').value,
                        summary: document.getElementById('summary').value
                    },
                    education: [],
                    experience: [],
                    skills: [],
                    achievements: [],
                    references: [],
                    completedSections: completedSections
                };

                // Save education
                document.querySelectorAll('#educationList .form-item').forEach(item => {
                    formData.education.push({
                        institution: item.querySelector('.education-institution').value,
                        degree: item.querySelector('.education-degree').value,
                        field: item.querySelector('.education-field').value,
                        gpa: item.querySelector('.education-gpa').value,
                        start: item.querySelector('.education-start').value,
                        end: item.querySelector('.education-end').value,
                        description: item.querySelector('.education-description').value
                    });
                });

                // Save experience
                document.querySelectorAll('#experienceList .form-item').forEach(item => {
                    const descriptions = Array.from(item.querySelectorAll('.experience-description')).map(desc => desc.value);
                    formData.experience.push({
                        company: item.querySelector('.experience-company').value,
                        position: item.querySelector('.experience-position').value,
                        location: item.querySelector('.experience-location').value,
                        start: item.querySelector('.experience-start').value,
                        end: item.querySelector('.experience-end').value,
                        descriptions: descriptions
                    });
                });

                // Save skills
                document.querySelectorAll('#skillsList .skill-item').forEach(item => {
                    formData.skills.push({
                        name: item.querySelector('.skill-name').value,
                        level: item.querySelector('.skill-level-select').value
                    });
                });

                // Save achievements
                document.querySelectorAll('#achievementsList .form-item').forEach(item => {
                    formData.achievements.push({
                        title: item.querySelector('.achievement-title').value,
                        date: item.querySelector('.achievement-date').value,
                        organization: item.querySelector('.achievement-organization').value,
                        description: item.querySelector('.achievement-description').value
                    });
                });

                // Save references
                document.querySelectorAll('#referencesList .form-item').forEach(item => {
                    formData.references.push({
                        name: item.querySelector('.reference-name').value,
                        title: item.querySelector('.reference-title').value,
                        company: item.querySelector('.reference-company').value,
                        email: item.querySelector('.reference-email').value,
                        phone: item.querySelector('.reference-phone').value
                    });
                });

                localStorage.setItem('cvFormData', JSON.stringify(formData));
            } catch (error) {
                console.error('Error saving form data:', error);
            }
        }

        function loadSavedData() {
            try {
                const savedData = localStorage.getItem('cvFormData');
                const savedImage = localStorage.getItem('cvProfileImage');
                
                if (savedImage) {
                    const placeholder = document.getElementById('profilePlaceholder');
                    const image = document.getElementById('profileImage');
                    placeholder.style.display = 'none';
                    image.src = savedImage;
                    image.style.display = 'block';
                }
                
                if (savedData) {
                    const data = JSON.parse(savedData);
                    
                    // Load completed sections
                    if (data.completedSections) {
                        completedSections = data.completedSections;
                        updateProgress();
                    }
                    
                    // Load personal info
                    if (data.personal) {
                        Object.keys(data.personal).forEach(key => {
                            const element = document.getElementById(key);
                            if (element) element.value = data.personal[key] || '';
                        });
                    }

                    // Load education
                    if (data.education && data.education.length > 0) {
                        // Clear existing items
                        document.getElementById('educationList').innerHTML = '';
                        educationCount = 0;
                        
                        data.education.forEach((edu, index) => {
                            const item = createEducationItem(index);
                            item.querySelector('.education-institution').value = edu.institution || '';
                            item.querySelector('.education-degree').value = edu.degree || '';
                            item.querySelector('.education-field').value = edu.field || '';
                            item.querySelector('.education-gpa').value = edu.gpa || '';
                            item.querySelector('.education-start').value = edu.start || '';
                            item.querySelector('.education-end').value = edu.end || '';
                            item.querySelector('.education-description').value = edu.description || '';
                            document.getElementById('educationList').appendChild(item);
                            educationCount++;
                        });
                        updateRemoveButtons('education');
                    }

                    // Load experience
                    if (data.experience && data.experience.length > 0) {
                        document.getElementById('experienceList').innerHTML = '';
                        experienceCount = 0;
                        
                        data.experience.forEach((exp, index) => {
                            const item = createExperienceItem(index);
                            item.querySelector('.experience-company').value = exp.company || '';
                            item.querySelector('.experience-position').value = exp.position || '';
                            item.querySelector('.experience-location').value = exp.location || '';
                            item.querySelector('.experience-start').value = exp.start || '';
                            item.querySelector('.experience-end').value = exp.end || '';
                            
                            if (exp.descriptions && exp.descriptions.length > 0) {
                                const descriptionsContainer = item.querySelector('.experience-descriptions');
                                descriptionsContainer.innerHTML = '';
                                
                                exp.descriptions.forEach((desc, descIndex) => {
                                    if (descIndex === 0) {
                                        const firstDesc = document.createElement('div');
                                        firstDesc.className = 'form-group';
                                        firstDesc.style.marginBottom = '0.5rem';
                                        firstDesc.innerHTML = `<textarea class="form-textarea experience-description" placeholder="Key achievement or responsibility..." required style="min-height: 80px;">${desc}</textarea>`;
                                        descriptionsContainer.appendChild(firstDesc);
                                    } else {
                                        const newDescription = document.createElement('div');
                                        newDescription.className = 'form-group';
                                        newDescription.style.marginBottom = '0.5rem';
                                        newDescription.innerHTML = `
                                            <div style="display: flex; gap: 0.5rem;">
                                                <textarea class="form-textarea experience-description" placeholder="Another key achievement..." style="min-height: 80px; flex: 1;">${desc}</textarea>
                                                <button type="button" class="remove-btn" onclick="this.closest('.form-group').remove()" style="height: fit-content; margin-top: 0.25rem;">
                                                    <i class="fas fa-minus"></i>
                                                </button>
                                            </div>
                                        `;
                                        descriptionsContainer.appendChild(newDescription);
                                    }
                                });
                            }
                            
                            document.getElementById('experienceList').appendChild(item);
                            experienceCount++;
                        });
                        updateRemoveButtons('experience');
                    }

                    // Load skills
                    if (data.skills && data.skills.length > 0) {
                        document.getElementById('skillsList').innerHTML = '';
                        skillsCount = 0;
                        
                        data.skills.forEach((skill, index) => {
                            const item = createSkillItem(index);
                            item.querySelector('.skill-name').value = skill.name || '';
                            item.querySelector('.skill-level-select').value = skill.level || 'Intermediate';
                            document.getElementById('skillsList').appendChild(item);
                            skillsCount++;
                        });
                        updateRemoveButtons('skills');
                    }

                    // Load achievements
                    if (data.achievements && data.achievements.length > 0) {
                        document.getElementById('achievementsList').innerHTML = '';
                        achievementsCount = 0;
                        
                        data.achievements.forEach((ach, index) => {
                            const item = createAchievementItem(index);
                            item.querySelector('.achievement-title').value = ach.title || '';
                            item.querySelector('.achievement-date').value = ach.date || '';
                            item.querySelector('.achievement-organization').value = ach.organization || '';
                            item.querySelector('.achievement-description').value = ach.description || '';
                            document.getElementById('achievementsList').appendChild(item);
                            achievementsCount++;
                        });
                        updateRemoveButtons('achievements');
                    }

                    // Load references
                    if (data.references && data.references.length > 0) {
                        document.getElementById('referencesList').innerHTML = '';
                        referencesCount = 0;
                        
                        data.references.forEach((ref, index) => {
                            const item = createReferenceItem(index);
                            item.querySelector('.reference-name').value = ref.name || '';
                            item.querySelector('.reference-title').value = ref.title || '';
                            item.querySelector('.reference-company').value = ref.company || '';
                            item.querySelector('.reference-email').value = ref.email || '';
                            item.querySelector('.reference-phone').value = ref.phone || '';
                            document.getElementById('referencesList').appendChild(item);
                            referencesCount++;
                        });
                        updateRemoveButtons('references');
                    }
                }
            } catch (error) {
                console.error('Error loading saved data:', error);
            }
        }
    </script>
</body>
</html>